<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>Structured Programming in SQL Notebook</title>

<h1>Structured Programming in SQL Notebook</h1>
<p>
    SQL Notebook provides a basic set of structured programming constructs that can be used from scripts and consoles.  They are roughly modeled on T-SQL's control flow syntax.  Semicolons are not required, but may be optionally included at the end of statements.  The use of semicolons may help resolve parsing ambiguities.
</p>
<ul>
    <li><a href="#declare">DECLARE Statement</a></li>
    <li><a href="#set">SET Statement</a></li>
    <li><a href="#if">IF Statement</a></li>
    <li><a href="#while">WHILE Statement</a></li>
    <li><a href="#break">BREAK Statement</a></li>
    <li><a href="#continue">CONTINUE Statement</a></li>
    <li><a href="#print">PRINT Statement</a></li>
    <li><a href="#execute">EXECUTE Statement</a></li>
    <li><a href="#return">RETURN Statement</a></li>
    <li><a href="#throw">THROW Statement</a></li>
    <li><a href="#try">TRY/CATCH Statement</a></li>
</ul>
<br>

<a name="declare"></a>
<h2>DECLARE Statement</h2>
<p>
    <b>Syntax:</b> <tt>DECLARE [PARAMETER] <i>variable-name</i> [= <i>expression</i>]</tt>
</p><p>
    Creates a new variable.  Variables must be declared before use.  Variables have script scope.  That is, the variable can be used anywhere else in the script, but it will not be visible to other scripts called using <tt>EXECUTE</tt>, nor to the parent script if this script was itself called with <tt>EXECUTE</tt>.  Variable names must begin with an at sign (<tt>@</tt>), dollar sign (<tt>$</tt>), or colon (<tt>:</tt>).
</p><p>
    If the <tt>PARAMETER</tt> keyword is used, then the variable becomes a parameter to the script.  If the script is called using <tt>EXECUTE</tt>, then the caller must provide a value for this parameter unless the <tt>DECLARE PARAMETER</tt> statement included a default <tt><i>expression</i></tt> value.
</p><p>
    If the <tt>DECLARE</tt> statement does not include the <tt>PARAMETER</tt> keyword nor a default <tt><i>expression</i></tt> value, then the variable takes the initial value of <tt>NULL</tt>.
</p><p>
    Unlike other popular SQL scripting languages, SQL Notebook's <tt>DECLARE</tt> statement does not accept a data type.  Variables follow the SQLite convention of allowing any data type to be stored.
</p>
<br>

<a name="set"></a>
<h2>SET Statement</h2>
<p>
    <b>Syntax:</b> <tt>SET <i>variable-name</i> = <i>expression</i></tt>
</p><p>
    Assigns a new value to a previously declared variable.  The new value does not need to be of the same type as the previous value.  It is an error to assign a value to an undeclared variable.
</p>
<br>

<a name="if"></a>
<h2>IF Statement</h2>
<p>
    <b>Syntax:</b> <tt>IF <i>expression</i> <i>statement-block</i> [ELSE <i>else-statement-block</i>]</tt>
</p><p>
    Takes one code path or the other based on an SQL expression.  The <tt><i>expression</i></tt> must evaluate to the integer 0 or 1.  Each <tt><i>statement-block</i></tt> may be either a single statement, or multiple statements starting with <tt>BEGIN</tt> and ending with <tt>END</tt>.
</p>
<br>

<a name="while"></a>
<h2>WHILE Statement</h2>
<p>
    <b>Syntax:</b> <tt>WHILE <i>expression</i> <i>statement-block</i></tt>
</p><p>
    Repeatedly executes the <tt><i>statement-block</i></tt> as long as the <tt><i>expression</i></tt> evaluates to the integer 1.  The <tt><i>statement-block</i></tt> may be either a single statement, or multiple statements starting with <tt>BEGIN</tt> and ending with <tt>END</tt>.
</p><p>
    The loop may be terminated without regard to the <tt><i>expression</i></tt> by using the <tt>BREAK</tt> statement.  The loop may be restarted without regard to the <tt><i>expression</i></tt> by using the <tt>CONTINUE</tt> statement.
</p>
<br>

<a name="break"></a>
<h2>BREAK Statement</h2>
<p>
    <b>Syntax:</b> <tt>BREAK</tt>
</p><p>
    Terminates the enclosing <tt>WHILE</tt> loop.  It is an error to call <tt>BREAK</tt> outside of a <tt>WHILE</tt> loop.
</p>
<br>

<a name="continue"></a>
<h2>CONTINUE Statement</h2>
<p>
    <b>Syntax:</b> <tt>CONTINUE</tt>
</p><p>
    Restarts the enclosing <tt>WHILE</tt> loop.  It is an error to call <tt>CONTINUE</tt> outside of a <tt>WHILE</tt> loop.
</p>
<br>

<a name="print"></a>
<h2>PRINT Statement</h2>
<p>
    <b>Syntax:</b> <tt>PRINT <i>expression</i></tt>
</p><p>
    Prints the <tt><i>expression</i></tt> to the script or console output.
</p>
<br>

<a name="execute"></a>
<h2>EXECUTE Statement</h2>
<p>
    <b>Syntax:</b> <tt>(EXEC | EXECUTE) [<i>return-variable-name</i> =] <i>script-name</i> (<i>parameter-name</i> = (<i>expression</i> | DEFAULT))*</tt>
</p><p>
    Executes the script called <tt><i>script-name</i></tt>, which may be enclosed in quotes if the script name contains spaces or special characters.  If a <tt><i>return-variable-name</i></tt> is specified, then that variable will contain the scalar value, if any, returned from the script.  If the script does not call <tt>RETURN</tt>, then the return value is <tt>NULL</tt>.
</p><p>
    The script may define input parameters using the <tt>DECLARE PARAMETER</tt> statement.  If so, the <tt>EXECUTE</tt> statement must provide argument values for those parameters.  The exception is if the <tt>DECLARE PARAMETER</tt> statement included a default value.  If so, then the <tt>EXECUTE</tt> statement may omit that parameter, or it may use the special keyword <tt>DEFAULT</tt>; in both cases, the default value defined by the <tt>DECLARE PARAMETER</tt> statement is used.
</p>
<br>

<a name="return"></a>
<h2>RETURN Statement</h2>
<p>
    <b>Syntax:</b> <tt>RETURN [<i>expression</i>]</tt>
</p><p>
    Ends script execution immediately.  If an <tt><i>expression</i></tt> is provided, then that value is returned to the caller.
</p>
<br>

<a name="throw"></a>
<h2>THROW Statement</h2>
<p>
    <b>Syntax:</b> <tt>THROW [<i>error-number-expression</i>, <i>error-message-expression</i>, <i>error-state-expression</i>]</tt>
</p><p>
    Throws an error.  There are no restrictions on what the three expressions must be, if they are provided.  They are returned as-is from the <tt>ERROR_NUMBER()</tt>, <tt>ERROR_MESSAGE()</tt>, and <tt>ERROR_STATE()</tt> functions.
</p>
<br>

<a name="try"></a>
<h2>TRY/CATCH Statement</h2>
<p>
    <b>Syntax:</b> <tt>BEGIN TRY <i>try-statement-block</i> END TRY BEGIN CATCH <i>catch-statement-block</i> END CATCH</tt>
</p><p>
    Executes <tt><i>try-statement-block</i></tt> until it finishes successfully or throws an error.  If an error is thrown, then <tt><i>catch-statement-block</i></tt> is executed.  The statements in the <tt>CATCH</tt> block may use the <tt>ERROR_NUMBER()</tt>, <tt>ERROR_MESSAGE()</tt>, and <tt>ERROR_STATE()</tt> functions to access the thrown error information.
</p>
